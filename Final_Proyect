import discord
import requests
from discord.ext import commands   #importaciones
import random

intents = discord.Intents.default()
intents.message_content = True

bot = commands.Bot(command_prefix='$', intents=intents, help_command=None)

#comandos

@bot.event     #evento de inicio
async def on_ready():
    print(f'Hemos iniciado sesi√≥n como {bot.user} - ¬°Bienvenido a {bot.user.name}!')

@bot.event      #evento de error de comando
async def on_command_error(ctx, error):
    if isinstance(error, commands.CommandNotFound):
        await ctx.send("¬°Comando no encontrado! Usa `$ayuda` para ver la lista de comandos disponibles.")

@bot.command()       #comando hola
async def hola(ctx):
    await ctx.send(f'Hola, soy un bot llamado {bot.user.name}!')

@bot.command()      #comando animal
async def animal(ctx):
    animales = [            #Lista de animales
        {
            "emoji": "üêß",
            "nombre": "Ping√ºino",
            "dato": "Los ping√ºinos est√°n en peligro debido al derretimiento del hielo marino en la Ant√°rtida.",
            "poblacion": "Aproximadamente 12 millones de individuos en todo el mundo.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/f/fc/Manchot_royal_-_King_Penguin.jpg"
        },
        {
            "emoji": "ü¶≠",
            "nombre": "Foca",
            "dato": "Las focas se ven afectadas por el calentamiento del oc√©ano y la p√©rdida de hielo √°rtico.",
            "poblacion": "Se estima que hay entre 30 y 40 millones de focas globalmente.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/thumb/7/76/Seehund11cele4_edit.jpg/1280px-Seehund11cele4_edit.jpg"
        },
        {
            "emoji": "üêò",
            "nombre": "Elefante",
            "dato": "Los elefantes sufren por la p√©rdida de su h√°bitat debido a la deforestaci√≥n.",
            "poblacion": "Quedan aproximadamente 415,000 elefantes en √Åfrica y 40,000 en Asia.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/5/59/Serengeti_Elefantenbulle.jpg"
        },
        {
            "emoji": "ü¶ã",
            "nombre": "Mariposa Monarca",
            "dato": "La migraci√≥n de la mariposa monarca ha disminuido por el cambio clim√°tico.",
            "poblacion": "Actualmente, su poblaci√≥n es de unos 100 millones, muy variable seg√∫n el a√±o.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/6/63/Monarch_In_May.jpg"
        },
        {
            "emoji": "üêª‚Äç‚ùÑÔ∏è",
            "nombre": "Oso Polar",
            "dato": "El oso polar depende del hielo marino para cazar, pero este se est√° derritiendo r√°pidamente.",
            "poblacion": "Se calcula que hay entre 22,000 y 31,000 osos polares en el mundo.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/0/09/Polar_Bear_-_Alaska.jpg"
        },
        {
            "emoji": "üê¢",
            "nombre": "Tortuga Marina",
            "dato": "Las tortugas marinas enfrentan riesgos por el aumento del nivel del mar y la contaminaci√≥n.",
            "poblacion": "Se estima que quedan entre 85,000 y 90,000 tortugas marinas adultas.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/7/71/GreenSeaTurtle-2.jpg"
        },
        {
            "emoji": "üê¨",
            "nombre": "Delf√≠n",
            "dato": "El aumento de la temperatura del oc√©ano afecta la alimentaci√≥n y migraci√≥n de los delfines.",
            "poblacion": "Existen aproximadamente 600,000 delfines mulares en el mundo.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/1/10/Tursiops_truncatus_01.jpg"
        },
        {
            "emoji": "ü¶ú",
            "nombre": "Guacamayo",
            "dato": "La destrucci√≥n de la selva pone en peligro a muchas especies de aves tropicales.",
            "poblacion": "La cantidad exacta var√≠a seg√∫n la especie, pero muchas est√°n en peligro debido a la deforestaci√≥n.",
            "imagen": "https://upload.wikimedia.org/wikipedia/commons/8/8a/Ara_macao_en_Zooaquarium_de_valencia%2C_Venezuela.jpg"
        },
    ]

    animal = random.choice(animales)
    # Agregar manejo de errores para la imagen
    try:
        embed = discord.Embed(       #embed
            title=f"{animal['emoji']} {animal['nombre']}",
            description=f"{animal['dato']}\n\n**Poblaci√≥n aproximada:** {animal['poblacion']}",
            color=0x2ecc71
        )
        embed.set_image(url=animal['imagen'])
        await ctx.send(embed=embed)
    except Exception as e:
        await ctx.send(f"Error al mostrar la imagen: {str(e)}")
        print(f"Error con la imagen de {animal['nombre']}: {str(e)}")


@bot.command(aliases=["help"])        #alias para el comando ayuda
async def ayuda(ctx):
    """Muestra una lista de comandos disponibles y su descripci√≥n."""
    mensaje = (
        f"**Comandos Disponibles de {bot.user.name}:**\n"
        "$hola - Saluda al bot.\n"
        "$clima [ciudad] - Obtiene el clima actual de una ciudad.\n"
        "$ayuda / $help - Muestra este mensaje de ayuda.\n"
        "$masinfo - Muestra enlaces para obtener m√°s informaci√≥n.\n"
        "$inundaciones - Informaci√≥n sobre inundaciones relacionadas al cambio clim√°tico.\n"
        "$tornados - Informaci√≥n sobre tornados extremos.\n"
        "$sequias - Informaci√≥n sobre sequ√≠as prolongadas.\n"
        "$catastrofes - Informaci√≥n sobre cat√°strofes clim√°ticas.\n"
        "$animal - Muestra un animal con dato ambiental y poblaci√≥n.\n"
        "$accion - Sugerencia de acci√≥n ecol√≥gica para el d√≠a.\n"
        "$frase - Muestra una frase inspiradora sobre el medio ambiente."
    )
    await ctx.send(mensaje)

@bot.command()
async def masinfo(ctx):       #mas informaci√≥n
    """Muestra enlaces para obtener m√°s informaci√≥n sobre el cambio clim√°tico."""
    mensaje = (
        "**M√°s Informaci√≥n sobre el Cambio Clim√°tico:**\n"
        "- Climate Crisis: Race We Can Win: https://www.un.org/es/un75/climate-crisis-race-we-can-win\n"
        "- Causas y Efectos del Cambio Clim√°tico: https://www.un.org/es/climatechange/science/causes-effects-climate-change"
    )
    await ctx.send(mensaje)

def get_weather(city: str) -> str:
    try:
        url = f"https://wttr.in/{city}?format=%C\n\nTemperatura: %t\nViento: %w\nHumedad: %h\nAmanecer: %S\nAtardecer: %s&lang=es"
        response = requests.get(url, timeout=10)
        if response.status_code == 200:
            return response.text.strip()
        else:
            return "No se pudo obtener la informaci√≥n del clima. Intenta m√°s tarde."
    except requests.RequestException:
        return "Error al obtener el clima. Verifica tu conexi√≥n o int√©ntalo m√°s tarde."

@bot.command()         #clima
async def clima(ctx, *, city: str):
    """Muestra el clima actual de una ciudad."""
    weather_info = get_weather(city)
    mensaje = f"**Clima en {city}:**\n{weather_info}"
    await ctx.send(mensaje)

@bot.command()         #inundaciones
async def inundaciones(ctx):
    """Muestra informaci√≥n sobre inundaciones relacionadas al cambio clim√°tico."""
    descripcion = (
        "**Inundaciones:**\n"
        "Las inundaciones, provocadas por lluvias intensas y el aumento del nivel del mar, son un efecto evidente del cambio clim√°tico.\n"
        "Fuente: https://www.un.org/es/climatechange/science/causes-effects-climate-change"
    )
    await ctx.send(descripcion)

@bot.command()         #tornados
async def tornados(ctx):
    """Muestra informaci√≥n sobre tornados extremos."""
    descripcion = (
        "**Tornados:**\n"
        "Los tornados pueden intensificarse y arrasar con aldeas, siendo un claro indicador de los extremos clim√°ticos generados por el cambio clim√°tico.\n"
        "Fuente: https://www.un.org/es/un75/climate-crisis-race-we-can-win"
    )
    await ctx.send(descripcion)

@bot.command()       #sequias
async def sequias(ctx):
    """Muestra informaci√≥n sobre sequ√≠as prolongadas."""
    descripcion = (
        "**Sequ√≠as:**\n"
        "Las sequ√≠as, o periodos prolongados de escasez de agua, se han vuelto m√°s comunes y severas por el cambio clim√°tico.\n"
        "Fuente: https://www.un.org/es/climatechange/science/causes-effects-climate-change"
    )
    await ctx.send(descripcion)

@bot.command()     #catastrofes
async def catastrofes(ctx):
    """Muestra informaci√≥n sobre cat√°strofes clim√°ticas."""
    descripcion = (
        "**Cat√°strofes Clim√°ticas:**\n"
        "El cambio clim√°tico puede desencadenar cat√°strofes como incendios forestales, tormentas extremas y huracanes que afectan a comunidades enteras.\n"
        "Fuente: https://www.un.org/es/un75/climate-crisis-race-we-can-win"
    )
    await ctx.send(descripcion)

@bot.command()     #acci√≥n ecol√≥gica
async def accion(ctx):
    """Sugiere una acci√≥n ecol√≥gica para ayudar al medio ambiente."""
    acciones = [
        "Hoy puedes ahorrar agua cerrando el grifo mientras te cepillas los dientes.",
        "Recicla tu basura pl√°stica para reducir la contaminaci√≥n.",
        "Apaga las luces que no est√©s usando para ahorrar energ√≠a.",
        "Utiliza bolsas reutilizables cuando vayas de compras.",
        "Camina o usa bicicleta para trayectos cortos en lugar del coche.",
        "Planta una planta o √°rbol para ayudar a mejorar la calidad del aire.",
        "Evita el uso de productos desechables de pl√°stico.",
        "Consume alimentos de producci√≥n local para reducir la huella de carbono.",
        "Reduce el consumo de papel usando medios digitales cuando sea posible.",
        "Usa el transporte p√∫blico para disminuir la contaminaci√≥n."
    ]
    sugerencia = random.choice(acciones)
    await ctx.send(f"üåø **Acci√≥n ecol√≥gica del d√≠a:** {sugerencia}")

@bot.command()         #frase ecol√≥gica
async def frase(ctx):
    """Muestra una frase inspiradora o informativa sobre el cuidado del medio ambiente."""
    frases = [
        "La Tierra no es una herencia de nuestros padres, sino un pr√©stamo de nuestros hijos.",
        "Cada peque√±o acto cuenta para salvar nuestro planeta.",
        "No hay un planeta B. Cuida el que tienes.",
        "El cambio clim√°tico es real y requiere acci√≥n inmediata.",
        "Planta un √°rbol y estar√°s ayudando a toda la humanidad.",
        "La naturaleza no es un lugar para visitar, es nuestro hogar.",
        "La contaminaci√≥n es el precio que pagamos por la indiferencia.",
        "Cuida el agua, es la sangre de la Tierra.",
        "El futuro de la humanidad depende de nuestras decisiones hoy.",
        "S√© el cambio que quieres ver en el mundo, empezando por el medio ambiente."
    ]
    mensaje = random.choice(frases)
    await ctx.send(f"üåé **Frase ecol√≥gica:** {mensaje}")







bot.run("TOKEN") #Token del bot
